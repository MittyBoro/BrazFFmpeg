# Laravel FFmpeg API Application

Это приложение предоставляет API для выполнения различных операций с видеофайлами с использованием библиотеки FFmpeg в среде Laravel 10. С его помощью вы можете получать информацию о видео, создавать изображения, миниатюры, трейлеры, изменять размер видео и отслеживать состояние выполнения задач.

Построено на базе [protonemedia/laravel-ffmpeg](https://github.com/protonemedia/laravel-FFmpeg)

Приложение разработано с использованием Laravel Sail, что обеспечивает легкость установки и развертывания, а также совместимость с контейнерами Docker для удобного разработки.

В Docker-контейнере laravelffmpeg добавлена установка FFmpeg 6.

Для обработки используются очереди Laravel с драйвером database.


## Маршруты

### Получение информации о видео
- **Метод:** POST
- **Путь:** /api/specifications
- **Параметры запроса:**
  - `src` (обязательный): URL исходного видео.
- **Описание:** Получить информацию о видео: ширину, высоту и продолжительность.
  **Пример ответа:**
```json
  {
    "width": 1920,
    "height": 1080,
    "duration": 120
  }
```


### Создание элементов

- **Метод:** POST
- **Путь:** /api/tasks/create/images
- **Параметры запроса:**
  - `src` (обязательный): URL исходного видео.
  - `webhook_url` (обязательный): URL для отправки уведомлений о завершении задачи.
  - `start` (опциональный): Начальная точка в видео.
  - `count` (опциональный): Количество изображений для создания.
  - `webhook_url` (опциональный): URL для отправки уведомлений о прогрессе и завершении задачи.
- **Описание:** Создаёт изображения из видео и возвращает идентификатор задачи (`task_id`).

- **Метод:** POST
- **Путь:** /api/tasks/create/thumbnails
- **Параметры запроса:**
  - `src` (обязательный): URL исходного видео.
  - `webhook_url` (опциональный): URL для отправки уведомлений о прогрессе и завершении задачи.
- **Описание:** Создаёт миниатюры из видео и возвращает идентификатор задачи (`task_id`).

- **Метод:** POST
- **Путь:** /api/tasks/create/trailer
- **Параметры запроса:**
  - `src` (обязательный): URL исходного видео.
  - `start` (опциональный): Начальная точка в видео.
  - `count` (обязательный): Количество кадров для создания трейлера.
  - `duration` (обязательный): Продолжительность трейлера.
  - `quality` (опциональный): Качество трейлера.
  - `webhook_url` (опциональный): URL для отправки уведомлений о прогрессе и завершении задачи.
- **Описание:** Создаёт трейлер из видео и возвращает идентификатор задачи (`task_id`).

- **Метод:** POST
- **Путь:** /api/tasks/create/resize
- **Параметры запроса:**
  - `src` (обязательный): URL исходного видео.
  - `quality` (обязательный): Новое качество видео (высота)
  - `webhook_url` (опциональный): URL для отправки уведомлений о прогрессе и завершении задачи.
- **Описание:** Изменяет размер видео по высоте (`quality`) и возвращает идентификатор задачи (`task_id`).


### Получение состояния процесса
- **Метод:** POST
- **Путь:** /api/tasks/{task_id}
- **Описание:** Этот маршрут позволяет получить текущее состояние процесса задачи по её id.

### Остановка процесса
- **Метод:** POST
- **Путь:** /api/tasks/{task_id}/stop
- **Описание:** Этот маршрут позволяет прекратить выполнение задачи по её id.
